<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script src="//apps.bdimg.com/libs/angular.js/1.4.6/angular.min.js"></script>
<script src="//apps.bdimg.com/libs/angular-route/1.3.13/angular-route.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-utf8-base64/0.0.5/angular-utf8-base64.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/markdown.js/0.5.0/markdown.min.js"></script>
<!--
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-base64/2.0.5/angular-base64.js"></script>
-->
<script type="text/javascript">
angular.module('ngRouteExample', ['ngRoute','ab-base64'])
.filter('base64_decode',function(){
    return function(input){
    }
})
.controller('HomeController', function ($scope,$http, $route) { 
    $scope.$route = $route;
    $http.get("https://api.github.com/repos/wangtongphp/wangtongphp.github.io/contents/source/_posts?ref=master")
        .success(function (response) {$scope.list= response;});
})
.controller('InfoController', function ($scope, $http, $route, $routeParams, base64) { 
    $scope.$route = $route;
    console.log($routeParams);
    $http.get('https://api.github.com/repos/wangtongphp/wangtongphp.github.io/contents/source/_posts/'+$routeParams.url)
        .success(function (response) {
            $scope.info = response;
            $scope.info.content = markdown.toHTML(base64.decode($scope.info.content), 'Maruku')
        });
})
.config(function ($routeProvider) {
    $routeProvider.
    when('/home', {
        templateUrl: 'embedded.home.html',
        controller: 'HomeController'
    }).
    when('/info/:url', {
        templateUrl: 'embedded.info.html',
        controller: 'InfoController'
    }).
    otherwise({
        redirectTo: '/home'
    });
});
</script>

  
</head>

<body ng-app="ngRouteExample" class="ng-scope">
  <script type="text/ng-template" id="embedded.home.html">
    <h1> Home </h1>
    <ul>
        <li ng-repeat="x in list" > <a href="#/info/{{x.name}}"> {{x.name}}</a> </li>
    </ul>
  </script>

  <script type="text/ng-template" id="embedded.info.html">
      <h1> {{info.name}} </h1>
        <div id="content">{{info.content}}</div>
  </script>

  <div> 
    <div id="navigation">  
      <a href="#/home">Home</a>
      <a href="#/info:3">InfoTest</a>
    </div>
      
    <div ng-view="">
    </div>
  </div>
</body>
</html>

